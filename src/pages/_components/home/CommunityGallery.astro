---
const communityImages = [
  {
    src: "https://www.react.dev/images/home/community/react_conf_fun.webp",
    alt: "People singing karaoke at React Conf",
  },
  {
    src: "https://www.react.dev/images/home/community/react_india_sunil.webp",
    alt: "Sunil Pai speaking at React India",
  },
  {
    src: "https://www.react.dev/images/home/community/react_conf_hallway.webp",
    alt: "A hallway conversation between two people at React Conf",
  },
  {
    src: "https://www.react.dev/images/home/community/react_india_hallway.webp",
    alt: "A hallway conversation at React India",
  },
  {
    src: "https://www.react.dev/images/home/community/react_conf_elizabet.webp",
    alt: "Elizabet Oliveira speaking at React Conf",
  },
  {
    src: "https://www.react.dev/images/home/community/react_india_selfie.webp",
    alt: "People taking a group selfie at React India",
  },
  {
    src: "https://www.react.dev/images/home/community/react_conf_nat.webp",
    alt: "Nat Alison speaking at React Conf",
  },
  {
    src: "https://www.react.dev/images/home/community/react_india_team.webp",
    alt: "Organizers greeting attendees at React India",
  },
];
---

<!-- container -->
<div
  class="relative w-auto overflow-x-hidden overflow-y-visible"
  id="communityGalleryContainer"
>
  <div
    class="flex animate-marquee py-12 lg:animate-large-marquee lg:py-20"
    style={{ animationPlayState: "paused" }}
    id="communityImagesContainer"
  >
    {
      communityImages.map(({ src, alt }, index) => (
        <div class="group relative min-w-[50%] rounded-2xl px-5 lg:min-w-[25%] ">
          <div
            class:list={[
              "rounded-2xl overflow-hidden transition-all ease-in-out duration-300",
              {
                "rotate-2 group-hover:rotate-[-1deg] group-hover:scale-110 group-hover:shadow-lg lg:group-hover:shadow-2xl":
                  index % 2 === 0,
                "group-hover:rotate-1 group-hover:scale-110 group-hover:shadow-lg lg:group-hover:shadow-2xl rotate-[-2deg]":
                  index % 2 !== 0,
              },
            ]}
          >
            <img
              src={src}
              alt={alt}
              class="aspect-[4/3] h-full w-full rounded-2xl bg-gray-10 object-cover dark:bg-gray-80"
            />
          </div>
        </div>
      ))
    }
  </div>

  <!-- Second gallery layered right on top and shifted to the end via the CSS animation rule -->
  <div
    class="absolute top-0 flex animate-marquee-tail py-12 lg:animate-large-marquee-tail lg:py-20"
    style={{ animationPlayState: "paused" }}
    id="communityImagesTailContainer"
  >
    {
      communityImages.map(({ src, alt }, index) => (
        <div class="group relative min-w-[50%] rounded-2xl px-5 lg:min-w-[25%] ">
          <div
            class:list={[
              "rounded-2xl overflow-hidden transition-all ease-in-out duration-300",
              {
                "rotate-2 group-hover:rotate-[-1deg] group-hover:scale-110 group-hover:shadow-lg lg:group-hover:shadow-2xl":
                  index % 2 === 0,
                "group-hover:rotate-1 group-hover:scale-110 group-hover:shadow-lg lg:group-hover:shadow-2xl rotate-[-2deg]":
                  index % 2 !== 0,
              },
            ]}
          >
            <img
              src={src}
              alt={alt}
              loading="lazy"
              class="aspect-[4/3] h-full w-full rounded-2xl bg-gray-10 object-cover dark:bg-gray-80"
            />
          </div>
        </div>
      ))
    }
  </div>
</div>

<script>
  const communityImagesTailContainer = document.getElementById(
    "communityImagesTailContainer"
  );

  const communityImagesContainer = document.getElementById(
    "communityImagesContainer"
  );

  const communityGalleryContainer = document.getElementById(
    "communityGalleryContainer"
  );

  if (
    communityGalleryContainer &&
    communityImagesContainer &&
    communityImagesTailContainer
  ) {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          communityImagesContainer.style.animationPlayState = "running";
          communityImagesTailContainer.style.animationPlayState = "running";
        }
      });
    });

    observer.observe(communityGalleryContainer);
  } else {
    console.error("community image elements not found ");
  }
</script>
